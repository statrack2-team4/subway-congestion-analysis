# 지하철 1호선 복합 지표 분석 가이드
## 소요시간 × 배차 간격 = 승객 대기 시간 지표

---

## 📌 분석 개요

### 핵심 아이디어
```
복합 지표 = 평균 소요시간 (분) × 평균 배차 간격 (분)
```

이 단순한 곱셈이 **승객의 실제 경험**을 잘 나타냅니다.

### 왜 이 지표가 중요한가?

**예시 1: 소요시간 10분, 배차 간격 5분**
- 복합 지표 = 10 × 5 = 50
- 의미: 빠르게 이동하고, 열차도 자주 온다 → 👍 좋은 서비스

**예시 2: 소요시간 10분, 배차 간격 20분**
- 복합 지표 = 10 × 20 = 200
- 의미: 빠르게 이동하지만, 열차를 오래 기다린다 → 😐 개선 필요

**예시 3: 소요시간 15분, 배차 간격 20분**
- 복합 지표 = 15 × 20 = 300
- 의미: 느리게 이동하고, 열차도 드물다 → 😞 심각한 문제

### 혼잡도와의 관계

```
복합 지표 높음
   ↓
승객이 오래 기다림 + 이동도 오래 걸림
   ↓
대기 승객 누적
   ↓
탑승 시 혼잡도 증가
```

---

## 🎯 분석 흐름

### 1단계: 기본 데이터 수집
```
역간 소요시간 계산
   ↓
출발역의 배차 간격 계산
```

### 2단계: 복합 지표 생성
```
각 구간마다:
  소요시간 × 배차 간격 = 복합 지표
```

### 3단계: 문제 구간 식별
```
복합 지표 큰 순서대로 정렬
   ↓
Top 50 구간 = 개선 필요 구간
```

### 4단계: 개선 방안 결정
```
배차 간격이 더 큰가? → 배차 증편
소요시간이 더 큰가? → 선로/신호 개선
둘 다 큰가? → 종합 개선
```

---

## 📊 주요 분석 결과

### 출력 파일 5개

| 파일명 | 내용 | 활용 방안 |
|--------|------|----------|
| `복합지표_Top50_주중.csv` | 주중 문제 구간 Top 50 | 평일 배차 계획 수립 |
| `복합지표_Top50_주말.csv` | 주말 문제 구간 Top 50 | 주말 배차 계획 수립 |
| `복합지표_주중주말비교.csv` | 주중/주말 차이 | 요일별 차등 운영 |
| `개선_우선순위_Top30.csv` | 개선 우선순위 + 방안 | 예산 배정 의사결정 |
| `복합지표_전체데이터.csv` | 전체 구간 데이터 | 상세 분석용 |

### Top 50 해석 방법

**CSV 파일 구조:**
```
구간, 방향, 평균소요시간_분, 평균배차간격_분, 복합지표, 측정횟수
의왕 → 성균관대, UP, 10.5, 15.3, 160.65, 45
```

**해석:**
- 의왕에서 성균관대까지 평균 10.5분 소요
- 의왕역에서 상행 열차가 평균 15.3분 간격으로 도착
- 복합 지표 160.65 = 승객 대기 시간 지표
- 45번 측정 = 데이터 신뢰도

---

## 📈 시각화 차트 해석

### 1. 막대 그래프 (Top 30)
- **X축**: 복합 지표 값
- **Y축**: 역 구간
- **색상**: 빨간색 진할수록 심각
- **읽는 법**: 위로 갈수록 문제가 심각한 구간

### 2. 산점도 (소요시간 vs 배차간격)
```
         배차 간격
             ↑
             │
   ⚠️ 최악   │   배차↑소요↓
   (둘다큼)  │   (배차만문제)
  ───────────┼───────────→ 소요시간
   배차↓소요↑│   ✅ 최적
   (소요만문제)│   (둘다작음)
```

- **점의 크기**: 복합 지표 (클수록 심각)
- **점의 색**: 복합 지표 (빨간색 진할수록 심각)
- **우상단**: 가장 문제가 심각한 구간
- **좌하단**: 가장 서비스가 좋은 구간

### 3. 히스토그램 (분포)
- **주중 vs 주말**: 어느 쪽이 더 심각한가?
- **평균선**: 전반적인 서비스 수준
- **꼬리 분포**: 극단적인 문제 구간 존재 여부

---

## 🎯 개선 우선순위 시트 활용법

### CSV 구조
```
구간, 방향, 평균소요시간_분, 평균배차간격_분, 복합지표,
소요시간_점수, 배차간격_점수, 종합점수, 개선방안
```

### 점수 해석 (0~100 스케일)
- **소요시간_점수**: 다른 구간 대비 소요시간 수준
  - 0 = 가장 빠름
  - 100 = 가장 느림
  
- **배차간격_점수**: 다른 구간 대비 배차 간격 수준
  - 0 = 가장 자주 옴
  - 100 = 가장 드묾
  
- **종합점수**: 가중 평균 (소요시간 30% + 배차간격 30% + 복합지표 40%)
  - 높을수록 개선 우선순위 높음

### 개선 방안 3가지

**1. "배차 증편 우선"**
- 배차간격_점수 > 소요시간_점수
- 의미: 열차가 드물게 오는 것이 더 큰 문제
- 조치: 운행 열차 수 증가, 운행 간격 단축
- 예산: 상대적으로 빠른 개선 가능

**2. "선로/신호 개선 우선"**
- 소요시간_점수 > 배차간격_점수
- 의미: 이동 시간이 오래 걸리는 것이 더 큰 문제
- 조치: 선로 개량, 신호 시스템 개선, 최고 속도 상향
- 예산: 중장기 투자 필요

**3. "종합 개선 필요"**
- 두 점수가 비슷하게 높음
- 의미: 소요시간도 길고 배차 간격도 김
- 조치: 단기(배차 증편) + 중장기(선로 개선) 병행
- 예산: 가장 많은 투자 필요

---

## 💡 실무 활용 시나리오

### 시나리오 1: 배차 계획 수립
**상황**: 주중 출퇴근 시간 배차 증편 검토

**활용**:
1. `복합지표_Top50_주중.csv` 열기
2. 복합지표 상위 10개 구간 확인
3. 해당 구간의 배차간격 확인
4. 증편 계획 수립 (예: 15분 → 10분)

**효과 예측**:
```
증편 전: 소요시간 10분 × 배차 15분 = 복합지표 150
증편 후: 소요시간 10분 × 배차 10분 = 복합지표 100
개선율: 33% 감소
```

### 시나리오 2: 예산 배정
**상황**: 선로 개선 예산 10억, 어느 구간에 투자?

**활용**:
1. `개선_우선순위_Top30.csv` 열기
2. "선로/신호 개선 우선" 구간 필터링
3. 종합점수 순으로 정렬
4. 상위 구간부터 예산 배정

**우선순위 기준**:
- 종합점수 80점 이상: 긴급
- 60~80점: 1년 내
- 40~60점: 3년 내

### 시나리오 3: 혼잡도 예측
**상황**: 실제 혼잡도 데이터와 결합

**활용**:
```python
# 복합지표와 혼잡도 상관관계 분석
import pandas as pd
import numpy as np

# 복합지표 데이터
df_metric = pd.read_csv('복합지표_전체데이터.csv')

# 실제 혼잡도 데이터 (가정)
df_congestion = pd.read_csv('실제_혼잡도.csv')

# 병합
df_merged = df_metric.merge(df_congestion, on=['구간', '방향'])

# 상관계수 계산
correlation = df_merged['복합지표'].corr(df_merged['혼잡도'])
print(f"상관계수: {correlation}")

# 회귀 분석으로 예측 모델 구축
from sklearn.linear_model import LinearRegression
model = LinearRegression()
model.fit(df_merged[['복합지표']], df_merged['혼잡도'])
```

---

## ⚠️ 주의사항 및 한계

### 데이터 품질
1. **측정 횟수 확인**: 측정 횟수 10회 미만 데이터는 신뢰도 낮음
2. **이상치 제거**: 0~60분 범위 벗어난 데이터는 이미 제외됨
3. **결측값**: 배차 간격 데이터가 없는 구간은 분석 불가

### 해석 한계
1. **단순 곱셈의 한계**: 
   - 실제 승객 경험은 더 복잡
   - 혼잡도, 환승 시간, 대기 공간 등 고려 안 됨

2. **평균의 함정**:
   - 시간대별 변동성 큼
   - 평균만으로는 피크 시간대 문제 파악 어려움

3. **인과관계 아님**:
   - 복합지표 높다 ≠ 혼잡도 높다 (상관관계일 뿐)
   - 실제 혼잡도는 승하차 인원 등 다른 요인도 중요

### 정책 적용 시 고려사항
1. **예산 제약**: 모든 구간을 동시에 개선할 수 없음
2. **기술적 제약**: 선로 용량, 차량 수 한계
3. **이해관계자**: 승객, 운영사, 지역 주민 등
4. **외부 요인**: 부동산 개발, 인구 변화 등

---

## 💬 FAQ

**Q1: 복합지표 단위가 "분²"인데 무슨 의미인가요?**
A: 수학적으로는 분의 제곱이지만, 실제로는 **상대적 비교 지표**입니다. 절대값보다는 다른 구간과의 비교가 중요합니다.

**Q2: Top 50이면 충분한가요?**
A: 예산과 인력에 따라 다릅니다. Top 10은 긴급, Top 30은 중요, Top 50은 관심 구간으로 보면 됩니다.

**Q3: 배차 증편하면 복합지표가 얼마나 개선되나요?**
A: 배차 간격이 20% 줄면, 복합지표도 약 20% 개선됩니다. (소요시간 일정 가정)

**Q4: 주중/주말 차이가 큰 구간은 어떻게 해야 하나요?**
A: 요일별 차등 운영을 고려하세요. 주중에만 증편하거나, 주말에는 일부 구간 감편도 가능합니다.

**Q5: 이 지표로 혼잡도를 예측할 수 있나요?**
A: 어느 정도 가능하지만, 실제 승하차 인원 데이터가 결합되면 훨씬 정확합니다.
