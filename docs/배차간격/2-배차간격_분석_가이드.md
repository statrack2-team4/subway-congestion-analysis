# 지하철 1호선 배차 간격 분석 가이드
## Headway Analysis - 열차가 얼마나 자주 오는가?

---

## 📌 배차 간격(Headway)이란?

### 정의
```
배차 간격 = 같은 역, 같은 방향에서 
           연속된 두 열차가 도착하는 시간 간격
```

### 예시
```
서울역 (하행 방향):
  열차 A: 08:00 도착
  열차 B: 08:05 도착
  → 배차 간격 = 5분

  열차 B: 08:05 도착
  열차 C: 08:12 도착
  → 배차 간격 = 7분
```

### 왜 중요한가?

**승객 입장**:
```
배차 간격 5분 → 평균 대기 2.5분
배차 간격 20분 → 평균 대기 10분
```

**운영 입장**:
```
배차 간격 짧다 → 많은 열차 필요 → 운영비 ↑
배차 간격 길다 → 적은 열차 → 승객 불편 ↑
```

---

## 🎯 분석 목적

### 1. 서비스 수준 평가
- 어느 역의 배차 간격이 긴가? (서비스 취약)
- 어느 역의 배차 간격이 짧은가? (서비스 우수)

### 2. 시간대별 패턴 파악
- 출퇴근 시간에 얼마나 증편하는가?
- 심야 시간에 배차가 얼마나 줄어드는가?

### 3. 일관성 평가
- 배차가 규칙적인가? (예측 가능)
- 배차가 불규칙한가? (승객 불편)

### 4. 개선 우선순위 결정
- 어느 역에 증편이 시급한가?
- 어느 시간대에 증편이 필요한가?

---

## 📊 주요 분석 결과

### 출력 파일 7개

| 파일명 | 내용 | 활용 |
|--------|------|------|
| `역별_배차간격_전체.csv` | 모든 역의 배차 통계 | 전체 현황 파악 |
| `역별_배차간격_Top30_주중.csv` | 주중 배차 긴 역 | 평일 증편 계획 |
| `역별_배차간격_Top30_주말.csv` | 주말 배차 긴 역 | 주말 증편 계획 |
| `배차간격_주중주말비교.csv` | 주중/주말 차이 | 요일별 차등 운영 |
| `배차간격_변동성_높은역.csv` | 불규칙한 역 | 정시성 개선 대상 |
| `배차간격_짧은역_Top30.csv` | 서비스 우수 역 | 벤치마크 |
| `배차간격_개선우선순위_Top30.csv` | 개선 우선순위 | 예산 배정 |

### CSV 파일 구조 예시

**역별_배차간격_Top30_주중.csv**:
```
역사명, 방향, 평균_분, 중앙값_분, 표준편차, 최소_분, 최대_분, 측정횟수
의왕, UP, 18.5, 17.0, 5.2, 10.0, 35.0, 45
```

**해석**:
- 의왕역 상행: 평균 18.5분마다 열차 도착
- 중앙값 17분 (평균과 비슷 = 극단값 적음)
- 표준편차 5.2분 (변동성 있음)
- 최소 10분 ~ 최대 35분 (큰 편차)
- 45회 측정 (신뢰도 높음)

---

## 📈 지표 해석 가이드

### 평균 배차 간격

| 범위 | 평가 | 승객 경험 |
|------|------|----------|
| 3~5분 | 매우 우수 | 거의 대기 없음 |
| 5~7분 | 우수 | 짧은 대기 |
| 7~10분 | 적정 | 보통 대기 |
| 10~15분 | 개선 필요 | 긴 대기 |
| 15분 이상 | 심각 | 매우 긴 대기 |

### 표준편차 (변동성)

| 범위 | 평가 | 의미 |
|------|------|------|
| 0~2분 | 매우 안정 | 시계처럼 정확 |
| 2~4분 | 안정 | 예측 가능 |
| 4~6분 | 보통 | 약간 불규칙 |
| 6~8분 | 불안정 | 예측 어려움 |
| 8분 이상 | 매우 불안정 | 승객 혼란 |

### 변동계수 (CV = 표준편차/평균)

| 범위 | 평가 |
|------|------|
| 0~0.2 | 일관성 높음 |
| 0.2~0.3 | 보통 |
| 0.3 이상 | 일관성 낮음 |

---

## 🎨 시각화 차트 해석

### 1. 막대 그래프 (Top 30)
```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 역 A (20분)
━━━━━━━━━━━━━━━━━━━ 역 B (15분)
━━━━━━━━━━━━━ 역 C (10분)
```

- **길이**: 배차 간격 (길수록 문제)
- **색상**: 빨간색 진할수록 심각
- **위로 갈수록**: 개선 우선순위 높음

### 2. 산점도 (평균 vs 변동성)
```
     표준편차
         ↑
         │
  ⚠️최악  │  변동만↑
  (둘다큼)│  (불규칙)
  ───────┼───────→ 평균
  배차만↑ │  ✅최적
  (드묾)  │  (둘다작음)
```

- **우상단**: 가장 문제 심각 (길고+불규칙)
- **좌하단**: 가장 이상적 (짧고+규칙적)
- **점 크기**: 측정 횟수 (신뢰도)

### 3. 시간대별 꺾은선 그래프
```
배차
간격  ╲                    ╱
(분)   ╲__________    ____╱
        07  09  18  20 (시)
        출근    퇴근
```

- **골짜기**: 증편 시간대 (출퇴근)
- **봉우리**: 감편 시간대 (심야)

---

## 💡 실무 활용 시나리오

### 시나리오 1: 증편 계획 수립

**상황**: 승객 불만이 많은 역 파악 필요

**Step 1**: `역별_배차간격_Top30_주중.csv` 열기
```
역사명, 평균_분
의왕, 18.5
성균관대, 17.2
...
```

**Step 2**: 평균 15분 이상 역 선정
```
의왕역: 18.5분 → 12분으로 단축 목표
성균관대: 17.2분 → 12분으로 단축 목표
```

**Step 3**: 필요 열차 수 계산
```
현재: 60분 / 18.5분 = 약 3.2대
목표: 60분 / 12분 = 5대
→ 약 2대 추가 필요
```

### 시나리오 2: 정시성 개선

**상황**: 배차가 불규칙한 역 개선

**Step 1**: `배차간격_변동성_높은역.csv` 열기
```
역사명, 평균_분, 표준편차, 변동계수
A역, 10, 6, 0.6  ← 변동계수 높음
```

**Step 2**: 원인 파악
- 신호 대기 시간 불규칙?
- 승하차 시간 편차 큼?
- 전 구간 지연 누적?

**Step 3**: 개선 방안
- 신호 시스템 최적화
- 정차 시간 표준화
- 여유 시간 확보

### 시나리오 3: 시간대별 배차 최적화

**Step 1**: 시간대별 평균 확인
```
시간대  평균배차(분)
07~09   5.2  ← 출근
10~17   8.5  ← 평시
18~20   5.8  ← 퇴근
21~23   12.0 ← 야간
```

**Step 2**: 수요 데이터와 비교
```
시간대  배차(분)  승객수
18~20   5.8      15,000 ← 혼잡
21~23   12.0     3,000  ← 여유
```

**Step 3**: 재배치
```
18~20시: 5.8분 → 4.5분 (증편)
21~23시: 12.0분 → 15.0분 (감편)
```

### 시나리오 4: 주중/주말 차등 운영

**Step 1**: `배차간격_주중주말비교.csv` 확인
```
역사명, DAY, SAT, 차이
관광역, 10, 8, +2  ← 주중이 더 길다
업무역, 7, 12, -5  ← 주말이 더 길다
```

**Step 2**: 차별화 전략
- **관광역**: 주말 증편 유지/강화
- **업무역**: 주말 감편 타당

---

## 🔍 심화 분석 아이디어

### 1. 탄력적 배차 시스템
```python
# 실시간 승객 수에 따른 동적 배차 조정
if 대기승객 > 임계값:
    배차간격 = 현재간격 * 0.8  # 20% 단축
else:
    배차간격 = 계획간격
```

### 2. 구간별 최적 배차
```python
# 역별로 다른 배차 간격 적용
도심역: 5분 간격
교외역: 15분 간격
종점역: 20분 간격
```

### 3. 계절/이벤트 대응
```python
# 특정 이벤트 시 임시 증편
if 대형이벤트 or 악천후:
    배차간격 *= 0.7
```

### 4. 예측 모델 구축
```python
from sklearn.ensemble import RandomForestRegressor

# 특성: 시간대, 요일, 날씨, 이벤트
# 목표: 최적 배차 간격 예측
model.fit(X_train, y_train)
```

---

## ⚠️ 주의사항

### 데이터 해석 시

1. **측정 횟수 확인**
   - 10회 미만: 신뢰도 낮음
   - 30회 이상: 신뢰도 높음

2. **이상치 제거**
   - 1분 미만: 제외 (측정 오류)
   - 60분 이상: 제외 (심야 첫차/막차)

3. **시간대 고려**
   - 평균만 보면 안 됨
   - 출퇴근 vs 평시 구분 필요

### 정책 수립 시

1. **예산 제약**
   - 배차 20% 증편 = 열차 20% 증가
   - 인건비, 유지비 고려

2. **물리적 한계**
   - 선로 용량 (최소 배차 간격 존재)
   - 차량 기지 크기

3. **수요 검증**
   - 배차만 늘린다고 혼잡도 해결 안 됨
   - 실제 승하차 인원 데이터 필요

---

## 🚀 다음 단계

### 이미 완료된 분석
- [x] 배차 간격 계산
- [x] 역별 통계 산출
- [x] 시간대별 패턴 분석
- [x] 개선 우선순위 도출

### 연계 분석
- [ ] 역간 소요시간과 결합 → 복합 지표
- [ ] 실제 혼잡도 데이터 연동
- [ ] 승하차 인원 분석
- [ ] 예측 모델 구축

### 정책 수립
- [ ] Top 10 역 증편 계획
- [ ] 시간대별 차등 배차
- [ ] 주중/주말 차별화

---

## 📞 FAQ

**Q1: 평균 배차 간격이 몇 분이면 적정한가요?**
```
도심 주요 역: 5~7분
일반 역: 7~10분
교외 역: 10~15분
```

**Q2: 배차를 20% 늘리면 효과는?**
```
현재 배차: 15분
증편 후: 12분 (20% 단축)
대기 시간: 7.5분 → 6분 (20% 감소)
```

**Q3: 변동성이 크면 어떻게 해야 하나요?**
```
원인 파악:
1. 신호 시스템 문제
2. 정차 시간 불규칙
3. 전 구간 지연 누적

해결:
1. 신호 최적화
2. 표준 정차 시간 설정
3. 여유 시간 확보
```

**Q4: 주중/주말 차이가 큰 것은 정상인가요?**
```
업무 지역: 주중 > 주말 (정상)
관광 지역: 주말 > 주중 (정상)
주거 지역: 비슷 (정상)
```

**Q5: 배차 간격이 짧은데도 혼잡하면?**
```
→ 배차 문제가 아님
→ 차량 용량 문제 or 승객 수 문제
→ 승하차 인원 데이터 필요
```

---

## 🎓 용어 정리

| 용어 | 영문 | 설명 |
|------|------|------|
| 배차 간격 | Headway | 연속 열차 도착 시간 간격 |
| 표준편차 | Standard Deviation | 변동성 지표 |
| 변동계수 | Coefficient of Variation | 상대적 변동성 (표준편차/평균) |
| 증편 | Service Increase | 운행 열차 수 증가 |
| 감편 | Service Reduction | 운행 열차 수 감소 |
| 정시성 | Punctuality | 계획 대비 실제 운행 정확도 |

---

## 💬 마무리

배차 간격은 **지하철 서비스 품질의 핵심 지표**입니다.

- 승객 대기 시간에 직접 영향
- 혼잡도 형성의 주요 원인
- 운영 효율성의 척도

이 분석을 통해:
1. 문제 역 식별 ✅
2. 개선 우선순위 도출 ✅
3. 데이터 기반 의사결정 지원 ✅
